FROM ubuntu:24.04@sha256:2e863c44b718727c860746568e1d54afd13b2fa71b160f5cd9058fc436217b30

ARG PUID=${PUID:-10000}
ARG PGID=${PGID:-10000}

COPY root /

RUN apt update && apt upgrade -y && apt install -y pokerth-server

RUN groupadd --gid $PGID pokerth && \
    useradd --uid $PUID --gid $PGID -s /usr/bin/bash -d /pokerth pokerth && \
    chown -R $PUID:$PGID /pokerth

RUN cp -r /usr/share/games/pokerth .
RUN cp -r /usr/share/doc/pokerth-server ./pokerth/
RUN cp -r /usr/share/doc/pokerth-data ./pokerth/
RUN cp -r /usr/games/pokerth_server ./pokerth/
COPY config.xml ./.pokerth/



EXPOSE 7234

USER pokerth

WORKDIR /pokerth

ENTRYPOINT ["/entrypoint.sh"]
